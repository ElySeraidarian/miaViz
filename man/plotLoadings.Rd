% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotLoadings.R
\name{plotLoadings}
\alias{plotLoadings}
\alias{plotLoadings,TreeSummarizedExperiment-method}
\alias{plotLoadings,matrix-method}
\title{Plot feature loadings after performing a reducedDim}
\usage{
plotLoadings(x, ...)

\S4method{plotLoadings}{TreeSummarizedExperiment}(x, dimred = "PCA", layout = "heatmap", n = 10, name = NULL, ...)

\S4method{plotLoadings}{matrix}(x, dimred = "PCA", layout = "heatmap", n = 10, name = NULL, ...)
}
\arguments{
\item{x}{a
\code{\link[TreeSummarizedExperiment:TreeSummarizedExperiment-class]{TreeSummarizedExperiment}}
x.}

\item{dimred}{One dimensionality reduction method of \code{c("PCA", "LDA", "NMF")}
indicating which method will be used.
(default: \code{dimred = "PCA"})}

\item{layout}{One way to plot feature loadings of \code{c("heatmap", "barplot", "screeplot", "tree")}
(default: \code{layout = "heatmap"})}

\item{n}{A numeric specifying the number of features to be plotted.
(default: \code{n = 10})}

\item{name}{A single \code{character} value specifying the name of the loadings matrix if it is
different from default naming. (default: \code{name = NULL})}
}
\value{
A \code{ggplot2} object. A circular plot annotated with TreeSummarizedExperiment object.
}
\description{
Inspired by the \code{\link[diffTop:plotASVcircular]{plotASVcircular}} method using phyloseq
and has been converted to use TreeSummarizedExperiment objects.
}
\details{
It is impossible to plot tree if only the matrix is given. Number of features must be reduced
before calling function or it will not be understandable.
}
\examples{


# Plotting feature loadings with tree
library(mia)
library(ggtree)
library(scater)
data("GlobalPatterns", package = "mia")
tse <- GlobalPatterns
tse <- transformAssay(tse, method = "clr", pseudocount = 1)
tse <- agglomerateByPrevalence(tse, rank="Phylum", update.tree = TRUE)
tse <- runPCA(tse, ncomponents = 2, assay.type = "clr")
plotLoadings(tse, dimred= "PCA", layout = "tree")


# Plotting without tree as a heatmap
loadings_matrix <- attr(reducedDim(tse, "PCA"), "rotation")
plotLoadings(loadings_matrix, dimred= "PCA", layout = "heatmap")

# Plotting without tree as a barplot
plotLoadings(loadings_matrix, dimred= "PCA", layout = "barplot")

# Plotting without tree as a screeplot
plotLoadings(loadings_matrix, dimred= "PCA", layout = "screeplot")

# Plotting more features
plotLoadings(loadings_matrix, dimred= "PCA", layout = "heatmap", n = 12)

# Plotting with more components
tse <- runPCA(tse, ncomponents = 4, assay.type = "clr")
loadings_matrix <- attr(reducedDim(tse, "PCA"), "rotation")
plotLoadings(loadings_matrix, dimred= "PCA", layout = "heatmap")

# Plotting if loadings matrix name has been changed
tse <- runPCA(tse, name = "myPCAmatrix", ncomponents = 2, assay.type = "clr")
plotLoadings(loadings_matrix, dimred= "PCA", layout = "heatmap", name = "myPCAmatrix")
}
\author{
Ely Seraidarian
Contact: \url{microbiome.github.io}
}
