% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotLoadings.R
\name{plotLoadings}
\alias{plotLoadings}
\alias{plotLoadings,TreeSummarizedExperiment-method}
\alias{plotLoadings,matrix-method}
\alias{plotLoadings,SingleCellExperiment-method}
\title{Plot feature loadings for TreeSummarizedExperiment/SingleCellExperiment objects
or feature loadings numeric matrix.}
\usage{
plotLoadings(x, ...)

\S4method{plotLoadings}{TreeSummarizedExperiment}(
  x,
  dimred = "PCA",
  layout = "tree",
  n = 10,
  ncomponents = 5,
  tree.name = "phylo",
  class = rownames(x),
  ...
)

\S4method{plotLoadings}{matrix}(
  x,
  dimred = "PCA",
  layout = "heatmap",
  n = 10,
  ncomponents = 5,
  ...
)

\S4method{plotLoadings}{SingleCellExperiment}(
  x,
  dimred = "PCA",
  layout = "heatmap",
  n = 10,
  ncomponents = 5,
  ...
)
}
\arguments{
\item{x}{a
\code{\link[TreeSummarizedExperiment:TreeSummarizedExperiment-class]{TreeSummarizedExperiment}}
x.}

\item{...}{additional arguments for plotting. See
\code{\link{mia-plot-args}} for more details i.e. call \code{help("mia-plot-args")}}

\item{dimred}{\code{Character scalar}. Dimension reduction from reducedDimNames to be plotted.
(default: \code{"PCA"})}

\item{layout}{One way to plot feature loadings of \code{c("heatmap", "barplot", "tree")}
(default: \code{"tree"} for TSE, \code{"heatmap"} for others)}

\item{n}{A numeric specifying the number of features to be plotted.
(default: \code{10})}

\item{ncomponents}{A numeric specifying the number of components.
(default: \code{5})}

\item{tree.name}{A single \code{character} value specifying a rowTree from a
TreeSummarizedExperiment object. (By default: \code{"phylo"})}

\item{class}{A single \code{character} value specifying a rank from taxonomyRanks
(default: \code{rownames})}
}
\value{
A \code{ggplot2} object. A circular plot annotated with TreeSummarizedExperiment object.
}
\description{
This function is used after performing a reduction method. If TSE object is
given it retrieves the feature loadings matrix to plot values with tree.
Plotting with other layouts is possible as SCE objects and numeric matrices
does not include a tree.
}
\details{
Inspired by the \code{\link[diffTop:plotASVcircular]{plotASVcircular}} method using phyloseq
and has been converted to use TreeSummarizedExperiment/SingleCellExperiment objects.

TreeSummarizedExperiment/SingleCellExperiment objects are expected to have content in reducedDim slot.
It is impossible to plot tree if only the matrix is given. Number of features must be reduced
before calling function or it will not be understandable. For example
agglomerating data by rank or prevalence (see examples).
}
\examples{

# Plotting feature loadings with tree
library(mia)
library(ggtree)
library(scater)
data("GlobalPatterns", package = "mia")
tse <- GlobalPatterns
tse <- transformAssay(tse, method = "clr", pseudocount = 1)
tse <- agglomerateByPrevalence(tse, rank="Phylum", update.tree = TRUE)
tse <- runPCA(tse, ncomponents = 5, assay.type = "clr")
plotLoadings(tse)

# Plotting without tree as a heatmap
loadings_matrix <- attr(reducedDim(tse, "PCA"), "rotation")
plotLoadings(loadings_matrix)

# Plotting without tree as a barplot
plotLoadings(loadings_matrix, layout = "barplot")

# Plotting more features
plotLoadings(loadings_matrix, n = 12)

# Plotting with less components
tse <- runPCA(tse, ncomponents = 4, assay.type = "clr")
loadings_matrix <- attr(reducedDim(tse, "PCA"), "rotation")
plotLoadings(loadings_matrix, ncomponents = 4)

# Plotting if loadings matrix name has been changed
tse <- runPCA(tse, name = "myPCAmatrix", ncomponents = 5, assay.type = "clr")
plotLoadings(tse, dimred= "myPCAmatrix")

# Plotting tree with taxonomic rank classification
tse <- runPCA(tse, ncomponents = 5, assay.type = "clr")
plotLoadings(tse, class = "Phylum")
}
\author{
Ely Seraidarian
Contact: \url{microbiome.github.io}
}
