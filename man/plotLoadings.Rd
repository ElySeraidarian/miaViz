% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotLoadings.R
\name{plotLoadings}
\alias{plotLoadings}
\alias{plotLoadings,TreeSummarizedExperiment-method}
\alias{plotLoadings,SingleCellExperiment-method}
\alias{plotLoadings,matrix-method}
\title{Plot feature loadings for TreeSummarizedExperiment
objects or feature loadings numeric matrix.}
\usage{
plotLoadings(x, ...)

\S4method{plotLoadings}{TreeSummarizedExperiment}(
  x,
  dimred,
  layout = "barplot",
  ncomponents = 5,
  tree.name = "phylo",
  row.var = NULL,
  add.tree = FALSE,
  ...
)

\S4method{plotLoadings}{SingleCellExperiment}(x, dimred, layout = "barplot", ncomponents = 5, ...)

\S4method{plotLoadings}{matrix}(x, layout = "barplot", ncomponents = 5, ...)
}
\arguments{
\item{x}{a
\code{\link[TreeSummarizedExperiment:TreeSummarizedExperiment-class]{TreeSummarizedExperiment}}
x.}

\item{...}{additional parameters for plotting.
\itemize{
\item \code{n}: \code{Integer scalar}. Number of features to be plotted.
Applicable when \code{layout="barplot"}. (Default: \code{10}))
}}

\item{dimred}{\code{Character scalar}.  Determines the reduced dimension to
plot.}

\item{layout}{\code{Character scalar}. Determines the layout of plot. Must be
either \code{"barplot"} or \code{"heatmap"}. (Default: \code{"barplot"})}

\item{ncomponents}{\code{Numeric scalar}. Number of components must be lower
or equal to the number of components chosen in the reduction method.
(Default: \code{5})}

\item{tree.name}{\code{Character scalar}. Specifies a rowTree/colTree from
\code{x}. (Default: \code{tree.name = "phylo"})}

\item{row.var}{\code{NULL} or \code{Character scalar}. Specifies a
variable from \code{rowData} to plot with tree heatmap layout.
(Default: \code{NULL})}

\item{add.tree}{\code{Logical scalar}. Whether to add tree to heatmap layout.
(Default: \code{FALSE})}
}
\value{
A \code{ggplot2} object.
}
\description{
This function is used after performing a reduction method. If \code{TreeSE}
is given it retrieves the feature loadings matrix to plot values.
A tree from \code{rowTree} can be added to heatmap layout.
}
\details{
Inspired by the \code{plotASVcircular} method using \code{phyloseq} and has been
converted to use TreeSummarizedExperiment/SingleCellExperiment objects.
TreeSummarizedExperiment/SingleCellExperiment objects are expected to have
content in reducedDim slot.
It is impossible to add tree if only the matrix is given.
Number of features must be reduced before calling function or it will not
be understandable. For example, agglomerating data by rank or
prevalence (see examples).
}
\examples{

# Plotting feature loadings with tree
library(mia)
library(ggtree)
library(scater)
data("GlobalPatterns", package = "mia")
tse <- GlobalPatterns
tse <- transformAssay(tse, method = "clr", pseudocount = 1)
tse <- agglomerateByPrevalence(tse, rank="Phylum", update.tree = TRUE)
tse <- runPCA(tse, ncomponents = 5, assay.type = "clr")
plotLoadings(tse, dimred = "PCA", layout = "heatmap", add.tree = TRUE)

# Plotting without tree as a barplot
loadings_matrix <- attr(reducedDim(tse, "PCA"), "rotation")
plotLoadings(loadings_matrix)

# Plotting more features
plotLoadings(loadings_matrix, n = 12)

# Plotting without tree as a heatmap
plotLoadings(loadings_matrix, layout = "heatmap")

# Plotting with less components
tse <- runPCA(tse, ncomponents = 4, assay.type = "clr")
loadings_matrix <- attr(reducedDim(tse, "PCA"), "rotation")
plotLoadings(loadings_matrix, ncomponents = 4)

# Plotting if loadings matrix name has been changed
tse <- runPCA(tse, name = "myPCAmatrix", ncomponents = 5, assay.type = "clr")
plotLoadings(tse, dimred = "myPCAmatrix")

# Plotting tree with taxonomic rank classification
tse <- runPCA(tse, ncomponents = 5, assay.type = "clr")
plotLoadings(tse, dimred = "PCA", layout = "heatmap", add.tree = TRUE,
row.var = "Phylum")

# Plotting after performing LDA 
library(topicmodels)
tse <- addLDA(tse)
plotLoadings(tse, dimred = "LDA", ncomponents = 2)

}
