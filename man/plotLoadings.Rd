% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotLoadings.R
\name{plotLoadings}
\alias{plotLoadings}
\alias{plotLoadings,TreeSummarizedExperiment-method}
\alias{plotLoadings,matrix-method}
\alias{plotLoadings,SingleCellExperiment-method}
\title{Plot feature loadings for TreeSummarizedExperiment/SingleCellExperiment objects
or feature loadings numeric matrix.}
\usage{
plotLoadings(x, ...)

\S4method{plotLoadings}{TreeSummarizedExperiment}(
  x,
  dimred,
  layout = "barplot",
  n = 10,
  ncomponents = 5,
  tree.name = "phylo",
  rank = NULL,
  add.tree = FALSE,
  ...
)

\S4method{plotLoadings}{matrix}(x, layout = "barplot", n = 10, ncomponents = 5, ...)

\S4method{plotLoadings}{SingleCellExperiment}(x, dimred, layout = "barplot", n = 10, ncomponents = 5, ...)
}
\arguments{
\item{x}{a
\code{\link[TreeSummarizedExperiment:TreeSummarizedExperiment-class]{TreeSummarizedExperiment}}
x.}

\item{...}{additional arguments for plotting. See
\code{\link{mia-plot-args}} for more details i.e. call \code{help("mia-plot-args")}}

\item{dimred}{\code{Character scalar}. Name of the reduction method if there are several in reducedDim slot.}

\item{layout}{\code{Character scalar}. One way to plot feature loadings of \code{c("heatmap", "barplot")}.
(Default: \code{"barplot"})}

\item{n}{\code{Numeric scalar}. Number of features to be plotted.
(Default: \code{10})}

\item{ncomponents}{\code{Numeric scalar}. Number of components must be lower or equal
to the number of components choosen in the reduction method.
(Default: \code{5})}

\item{tree.name}{\code{Character scalar}. Value specifying a rowTree from a
TreeSummarizedExperiment object.
(Default: \code{"phylo"})}

\item{rank}{\code{Character scalar}. Value specifying a rank from taxonomyRanks
(Default: \code{NULL})}

\item{add.tree}{\code{Logical scalar}. Whether or not to add tree to heatmap layout.
(Default: \code{FALSE})}
}
\value{
A \code{ggplot2} object. A circular plot annotated with TreeSummarizedExperiment object.
}
\description{
This function is used after performing a reduction method. If TSE object is
given it retrieves the feature loadings matrix to plot values, tree can be added to heatmap.
Plotting with other layouts is possible as SCE objects and numeric matrices
does not include a tree.
}
\details{
Inspired by the \code{\link[diffTop:plotASVcircular]{plotASVcircular}} method using phyloseq
and has been converted to use TreeSummarizedExperiment/SingleCellExperiment objects.

TreeSummarizedExperiment/SingleCellExperiment objects are expected to have content in reducedDim slot.
It is impossible to add tree if only the matrix is given. Number of features must be reduced
before calling function or it will not be understandable. For example
agglomerating data by rank or prevalence (see examples).
}
\examples{

# Plotting feature loadings with tree
library(mia)
library(ggtree)
library(scater)
library(shadowtext)
library(tidytext)
data("GlobalPatterns", package = "mia")
tse <- GlobalPatterns
tse <- transformAssay(tse, method = "clr", pseudocount = 1)
tse <- agglomerateByPrevalence(tse, rank="Phylum", update.tree = TRUE)
tse <- runPCA(tse, ncomponents = 5, assay.type = "clr")
plotLoadings(tse, dimred = "PCA", layout = "heatmap", add.tree = TRUE)

# Plotting without tree as a heatmap
loadings_matrix <- attr(reducedDim(tse, "PCA"), "rotation")
plotLoadings(loadings_matrix, dimred = "PCA", layout = "heatmap")

# Plotting without tree as a barplot
plotLoadings(loadings_matrix, dimred = "PCA")

# Plotting more features
plotLoadings(loadings_matrix, n = 12, dimred = "PCA")

# Plotting with less components
tse <- runPCA(tse, ncomponents = 4, assay.type = "clr")
loadings_matrix <- attr(reducedDim(tse, "PCA"), "rotation")
plotLoadings(loadings_matrix, dimred = "PCA", ncomponents = 4)

# Plotting if loadings matrix name has been changed
tse <- runPCA(tse, name = "myPCAmatrix", ncomponents = 5, assay.type = "clr")
plotLoadings(tse, dimred = "myPCAmatrix")

# Plotting tree with taxonomic rank classification
tse <- runPCA(tse, ncomponents = 5, assay.type = "clr")
plotLoadings(tse, dimred = "PCA", layout = "heatmap", add.tree = TRUE, rank = "Phylum")

# Plotting after performing LDA method
tse <- addLDA(tse)
plotLoadings(tse, dimred = "LDA", ncomponents = 2)
}
\author{
Ely Seraidarian
Contact: \url{microbiome.github.io}
}
